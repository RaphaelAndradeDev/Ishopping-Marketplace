function filter(){var n=0;$("tr").each(function(){if(!isNaN(parseInt($(this).prop("class")))){$(this).hide();var t=parseInt($(this).prop("class"));n=t>n?t:n}});$("."+n).show()}function showAll(){$("tr").each(function(){isNaN(parseInt($(this).prop("class")))||$(this).show()})}function GetTemplate(){$.ajax({url:"/Plan/GetTemplate",type:"POST",data:{group:group},dataType:"json"}).success(function(n){$("#ddmTemplate").empty();$("#ddmView").empty();$(n.template).each(function(n,t){$("#ddmTemplate").append("<li><a name='TemplateCod' id='"+t.cod+"'>"+t.name+"<\/a><\/li>")});$("#tabItens").text(n.financial.PlanName);$("#tabMonth").text(n.financial.Month);$("#tabValue").text(n.financial.PlanValue);$("#tabBalance").text(n.financial.Balance);$("#tabBonus").text(n.financial.Bonus);$("#tabDueDate").text(n.financial.DueDate);$("#payment").text(n.financial.Payment)}).error(function(){alert("Nenhum resultado encontrado")})}function GetView(){$.ajax({url:"/Plan/GetView",data:{templateCod:templateCod},type:"POST",dataType:"json"}).success(function(n){$("#ddmView").empty();$(n).each(function(n,t){$("#ddmView").append("<li><a name='ViewStart' id='"+t.cod+"'>"+t.name+"<\/a><\/li>")})}).error(function(){alert("Nenhum resultado encontrado")})}function Salvar(){$.ajax({url:"/Plan/Salvar",data:{group:group,templateCod:templateCod,viewCod:viewCod,plan:plan},type:"POST",cache:!1,headers:{__RequestVerificationToken:token},dataType:"json",beforeSend:function(){loadingOn()}}).success(function(n){n.Redirect?window.location.href=n.RedirectUrl:(loadingOff(),$("#Status").html(n.Message),$("#Status").fadeIn(500))}).error(function(){loadingOff();alert("Não foi possível salvar os dados")})}function Pay(){name=$("#name").val();email=$("#email").val();areaCod=$("#areaCod").val();phone=$("#phone").val();cpf=$("#cpf").val();$.ajax({url:"/Plan/Pay",data:{company:1,name:name,email:email,areaCod:areaCod,phone:phone,cpf:cpf},type:"POST",cache:!1,headers:{__RequestVerificationToken:token},dataType:"json",beforeSend:function(){loadingOn()}}).success(function(n){n.Redirect?window.location.href=n.RedirectUrl:(loadingOff(),$("#Status").html(n.Message),$("#Status").fadeIn(500))}).error(function(){loadingOff();alert("Não foi possível efetuar o pagamento")})}function loadingOn(){viewDisabled();$(".container").css({opacity:.3});$("#defaultForm").append('<img id="imgload" src="../../Images/Ishopping/loading.gif" />')}function loadingOff(){viewEnable();$(".container").css({opacity:1});$("#imgload").remove()}function viewDisabled(){$("input,button,textarea").prop("disabled",!0)}function viewEnable(){$("input,button,textarea").prop("disabled",!1)}var txt="Valor promocional do plano:  ",group,plan,templateCod,templateCodOld,viewCod,viewCodOld,token=$("[name=__RequestVerificationToken]").val();$(document).ready(function(){var i=$("#_dataValues").data("_appmenu"),r=$("#_dataValues").data("_activefor"),n=i.split(","),t;$.each(n,function(n,t){$("#"+t).removeClass("disabled")});t="/"+n[0]+"/index/"+n[1];$("#homePage").attr("href",t);$("#"+r).addClass("active")});$(document).ready(function(){$(".dropdown-toggle").dropdown();$("#salvar").popover({trigger:"hover",content:'<p><span class="glyphicon glyphicon-info-sign text-info"><\/span> Atenção: Ao trocar de template, todas as suas imagens e configurações anteriores serão excluídas.<\/p>',html:!0});$("#pay").popover({trigger:"hover"});$("#infoPlan").click(function(){$("#myModalInfoPlan").modal("show")});$("#infoPayment").click(function(){$("#myModalInfoPayment").modal("show")});$("#historic").click(function(){$("#myModalHistoric").modal("show")});filter()});$("#filter").on("click",function(){$(this).prop("checked")?showAll():filter()});$(".form-control").on("change",function(){$("#Status").fadeOut(500)});$(document).ready(function(){$.ajax({url:"/Plan/GetPlan",type:"POST",dataType:"json"}).success(function(n){$("#value").empty();$("#ddmTemplate").empty();$("#ddmView").empty();$(".group").html(n.GroupName+"&nbsp;&nbsp;<span class='caret'><\/span>");$(".template").html(n.TemplateName+"&nbsp;&nbsp;<span class='caret'><\/span>");$(".view").html(n.ViewName+"&nbsp;&nbsp;<span class='caret'><\/span>");group=n.KeyGroup;templateCod=n.KeyTemplete;templateCodOld=n.KeyTemplete;viewCod=n.KeyViewStart;viewCodOld=n.KeyViewStart;$("#templateHeader").prop("disabled",!0);$("#viewHeader").prop("disabled",!0);$("#textValue").append("<p class='color1'>"+txt+n.Price+" por mês.<\/p>")}).error(function(){alert("Nenhum resultado encontrado")})});$("#salvar").on("click",function(){viewCod!=0&&(templateCod!=templateCodOld?$("#myModalNewTemplate").modal("show"):viewCod!=viewCodOld&&$("#myModalNewView").modal("show"))});$(document).ready(function(){$("[name='Group']").on("click",function(){var n=$(this).text();group=$(this).attr("id");group=group.replace("g_","");$(this).parents(".btn-group").find(".group").html(n+"   <span class='caret'><\/span>");$("#templateHeader").html('Selecione um template <span class="caret"><\/span>');$("#viewHeader").html('Selecione uma página inicial <span class="caret"><\/span>');$("#templateHeader").prop("disabled",!1);$("#viewHeader").prop("disabled",!0);viewCod=0;GetTemplate()});$(document).on("click","[name='TemplateCod']",function(){var n=$(this).text();templateCod=$(this).attr("id");$(this).parents(".btn-group").find(".template").html(n+"   <span class='caret'><\/span>");$("#viewHeader").html('Selecione uma página inicial <span class="caret"><\/span>');$("#viewHeader").prop("disabled",!1);viewCod=0;GetView()});$(document).on("click","[name='ViewStart']",function(){var n=$(this).text();viewCod=$(this).attr("id");$(this).parents(".btn-group").find(".view").html(n+"   <span class='caret'><\/span>")})});$(document).ready(function(){$("#defaultForm").bootstrapValidator({message:"This value is not valid",fields:{name:{validators:{notEmpty:{},stringLength:{max:64}}},email:{validators:{emailAddress:{}}},areaCod:{validators:{notEmpty:{},between:{min:11,max:99}}},phone:{validators:{notEmpty:{},integer:{message:"Apenas números são permitidos"},stringLength:{min:8,max:9}}},cpf:{validators:{notEmpty:{},integer:{message:"Apenas números são permitidos"},stringLength:{min:11,max:11,message:"O campo CPF deve conter 11 digitos"}}}}}).on("success.form.bv",function(n){n.preventDefault();var t=$(n.target),i=t.data("bootstrapValidator");Pay()})});